# **Three-Layer API Strategy — Summary**

TaraKernel adopts a **three-layer separation** between internal logic, public APIs, and Julia integration.
The goal is to keep the kernel **strict, stable, and safe**, while allowing higher-level tools and users to flexibly extend or customize behavior.

---

## **1. Layer 1 — `_lite_*` (Internal Plumbing)**

This layer contains all **invariant-enforcing kernel logic**:

* canonicalization
* lite-value validation
* hashing
* immutability rules
* tape semantics
* segment ordering
* meta consistency
* recovery logic

These functions are **not meant to be overridden**.
They define the “hardware rules” of TaraKernel and guarantee correctness across the entire ecosystem.

**Guarantee:**
Everything in TaraKernel is internally implemented in terms of `_lite_*` functions.

---

## **2. Layer 2 — `lite_*` (Public, Stable Kernel API)**

This is the **official extension surface** of the kernel.
Each `lite_*` function is a thin wrapper around the corresponding `_lite_*` plumbing function.

Characteristics:

* Safe for users, frameworks, and other libraries to extend or adapt.
* Encapsulates the kernel’s semantics without exposing internal structures.
* Provides stable, documented, long-term API endpoints.
* Allows customization while still being able to call the original behavior through `_lite_*`.

**Purpose:**
Let users build domain logic, wrappers, alternative UIs, or specialized backends without breaking kernel invariants.

---

## **3. Layer 3 — `Base.*` (Julia Sugar / Porcelain)**

This is the **syntactic integration layer** that makes TaraKernel feel natural in Julia:

by default:
* `Base.getindex` forwards to `lite_get`
* `Base.iterate` forwards to `lite_iterate`
* `Base.length` forwards to `lite_length`
* etc.

These methods are:

* logically minimal,
* purely convenience,
* safe for users to override or extend,
* never contain invariant-critical logic.

**Rule:**
`Base.*` methods *only* call `lite_*`, never `_lite_*`.

---

# **Benefits**

* **Strong correctness:** invariants live only in one place (Layer 1).
* **Extensibility:** users and frameworks extend Layer 2 safely.
* **Interoperability:** Layer 3 gives natural Julia behavior without forcing it.
* **Future-proofing:** evolving TaraSON, Tapes, or record semantics affects only Layer 1.
* **Ecosystem scale:** supports diverse tools, languages, and backends without fragility.

---

# **Essence**

> **Layer 1 defines the rules.
> Layer 2 exposes stable APIs.
> Layer 3 provides syntactic sugar.
>
> Only Layer 1 is strict; Layers 2 and 3 remain flexible.**

This structure makes TaraKernel robust as a universal, low-level substrate while remaining adaptable for a large, heterogeneous software ecosystem.
